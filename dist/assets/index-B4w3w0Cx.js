import{r as n,j as e}from"./index-DRYYJggy.js";import{m as h}from"./mock-rGEZ3HGA.js";import{f as b}from"./index-Cv2_veDm.js";import{u as T}from"./user-CTfc_bTd.js";import{P as B,R as V}from"./Table-CL1K4gcX.js";import{M as m}from"./index-DayXL3Em.js";import{C as p}from"./index-CN7zSww5.js";import{B as a,a as z}from"./index-DQU_F6Fm.js";import{F as L}from"./Table-6zcBRtZI.js";import"./index-C1WG2uQ_.js";import"./index-Bj386uoF.js";import"./context-Bi0jcZUX.js";import"./CloseOutlined-BqKTODZs.js";import"./index-B74T4Ixe.js";import"./EllipsisOutlined-BVGyxfd1.js";import"./index-CBuGrdmH.js";import"./PlusOutlined-CDU51U6T.js";import"./index-BBcq28iL.js";const X=()=>{const u=n.useRef(null),[x,o]=n.useState(!1),[f,l]=n.useState(!1),[s,g]=n.useState(null),[j,w]=n.useState([]),{user:d}=T(),v=t=>{g(t),o(!0)},y=async t=>{const r=await h.getLeaveRecords(),i=new Date(t.date),S=i.getFullYear(),C=i.getMonth()+1,D=r.filter(M=>{const c=new Date(M.startDate);return c.getFullYear()===S&&c.getMonth()+1===C});w(D),l(!0)},I=[{title:"请假类型",dataIndex:"leaveType",width:120,render:t=>({annual:"年假",sick:"病假",personal:"事假",maternity:"产假",other:"其他"})[t]||t},{title:"开始日期",dataIndex:"startDate",width:120},{title:"结束日期",dataIndex:"endDate",width:120},{title:"请假时长",dataIndex:"days",width:100,render:t=>e.jsxs("span",{children:[t,"天"]})}],R=[{title:"月份",dataIndex:"date",width:120,render:(t,r)=>r.date?new Date(r.date).toLocaleDateString("zh-CN",{year:"numeric",month:"long"}):"-"},{title:"填报人",dataIndex:"userName",width:100},{title:"实报工时",dataIndex:"totalHours",width:100,valueType:"digit",hideInSearch:!0,render:t=>e.jsx("span",{style:{fontWeight:600},children:t})},{title:"应报工时",dataIndex:"requiredHours",width:120,valueType:"digit",hideInSearch:!0,render:t=>e.jsx("span",{style:{fontWeight:600,color:"#FA8C16"},children:t})},{title:"请假情况",dataIndex:"leave",width:100,hideInSearch:!0,render:(t,r)=>e.jsx(a,{type:"link",size:"small",icon:e.jsx(V,{}),onClick:()=>y(r),children:"查看"})},{title:"提交时间",dataIndex:"submitTime",width:180,hideInSearch:!0},{title:"操作",valueType:"option",width:100,fixed:"right",render:(t,r)=>e.jsx(a,{type:"link",size:"small",icon:e.jsx(z,{}),onClick:()=>v(r),children:"查看"},"view")}];return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:e.jsx("h2",{style:{fontSize:"20px",fontWeight:600,margin:0},children:"我的团队"})}),e.jsx(B,{columns:R,actionRef:u,request:async()=>{if(!d?.id)return{data:[],success:!0,total:0};const r=(await h.getMonthReports()).filter(i=>i.userId!==d?.id);return{data:r,success:!0,total:r.length}},rowKey:"id",pagination:{defaultPageSize:10,showSizeChanger:!0},dateFormatter:"string",headerTitle:"我的团队",scroll:{x:1e3,y:"calc(100vh - 350px)"},options:{density:!1,fullScreen:!1,reload:!0,setting:!1}}),e.jsx(m,{title:"查看月报",open:x,onCancel:()=>o(!1),footer:[e.jsx(a,{onClick:()=>o(!1),children:"关闭"},"close")],width:800,children:s&&e.jsxs("div",{children:[e.jsxs(p,{size:"small",style:{marginBottom:16},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"填报人："}),s.userName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"填报日期："}),b(s.date)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"总工时："}),s.totalHours]}),e.jsxs("p",{children:[e.jsx("strong",{children:"应报工时："}),s.requiredHours]})]}),e.jsx(p,{size:"small",title:"工时分配",children:s.tasks.map((t,r)=>e.jsxs("div",{style:{marginBottom:12,padding:"12px",border:"1px solid #E5E6EB",borderRadius:"4px"},children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"项目："}),t.projectName]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"任务："}),t.taskName]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("strong",{children:"工时："}),t.hours,"h"]}),t.description&&e.jsxs("div",{children:[e.jsx("strong",{children:"详情："}),t.description]})]},r))})]})}),e.jsx(m,{title:"当月请假情况",open:f,onCancel:()=>l(!1),footer:[e.jsx(a,{onClick:()=>l(!1),children:"关闭"},"close")],width:800,children:e.jsx(L,{columns:I,dataSource:j,rowKey:"id",pagination:!1,locale:{emptyText:"当月无请假记录"}})})]})};export{X as default};
