import{r as c,u as D,j as e}from"./index-DRYYJggy.js";import{m as _}from"./mock-rGEZ3HGA.js";import{f as j}from"./index-Cv2_veDm.js";import{z as v}from"./index-C1WG2uQ_.js";import{F as i,B as u,I as p,s as y}from"./index-DQU_F6Fm.js";import{P as M,D as $}from"./Table-CL1K4gcX.js";import{R as V}from"./PlusOutlined-CDU51U6T.js";import{I}from"./index-Bj386uoF.js";import{R as q}from"./CheckSquareOutlined-DnXrTPPF.js";import{M as w}from"./index-DayXL3Em.js";import{S as l}from"./Table-6zcBRtZI.js";import{T as b}from"./index-DJ8YaTK5.js";import"./context-Bi0jcZUX.js";import"./CloseOutlined-BqKTODZs.js";import"./index-B74T4Ixe.js";import"./EllipsisOutlined-BVGyxfd1.js";import"./index-CBuGrdmH.js";import"./index-BBcq28iL.js";var z={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function m(){return m=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o])}return a},m.apply(this,arguments)}const B=(a,s)=>c.createElement(I,m({},a,{ref:s,icon:z})),A=c.forwardRef(B);var N={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};function h(){return h=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(a[o]=n[o])}return a},h.apply(this,arguments)}const W=(a,s)=>c.createElement(I,h({},a,{ref:s,icon:N})),K=c.forwardRef(W),{RangePicker:L}=$,ue=()=>{const a=D(),s=c.useRef(null),[n]=i.useForm(),[o,d]=c.useState(!1),[x,g]=c.useState(null),O=()=>{g(null),n.resetFields(),d(!0)},T=t=>{g(t),n.setFieldsValue({...t,planTime:[v(t.planStartTime),v(t.planEndTime)]}),d(!0)},F=async()=>{w.confirm({title:"确认删除",content:"确定要删除该项目吗？",onOk:async()=>{y.success("删除成功"),s.current?.reload()}})},S=async()=>{try{await n.validateFields(),y.success(x?"更新成功":"创建成功"),d(!1),s.current?.reload()}catch(t){console.error("Validation failed:",t)}},C=t=>({empower:"blue",support:"green",maintenance:"orange"})[t]||"default",E=t=>({in_progress:"blue",pending:"yellow",completed:"green",paused:"red"})[t]||"default",R=t=>({empower:"赋能项目",support:"支持项目",maintenance:"维护项目"})[t]||t,H=t=>({in_progress:"进行中",pending:"待启动",completed:"已完成",paused:"暂停"})[t]||t,P=[{title:"序号",dataIndex:"id",valueType:"index",width:60,align:"center"},{title:"项目名称",dataIndex:"name",width:200,render:t=>e.jsx("a",{style:{color:"#1677FF"},children:t})},{title:"项目分类",dataIndex:"category",width:120,valueType:"select",valueEnum:{empower:{text:"赋能项目",status:"Default"},support:{text:"支持项目",status:"Success"},maintenance:{text:"维护项目",status:"Processing"}},render:(t,r)=>e.jsx(b,{color:C(r.category),children:R(r.category)})},{title:"负责人",dataIndex:"managerName",width:120},{title:"计划时间",dataIndex:"planStartTime",width:180,valueType:"dateRange",search:!1,render:(t,r)=>`${j(r.planStartTime)} ~ ${j(r.planEndTime)}`},{title:"预计工时",dataIndex:"totalHours",width:100,valueType:"digit",render:t=>e.jsxs("span",{style:{fontWeight:600},children:[t,"h"]})},{title:"已用工时",dataIndex:"consumedHours",width:100,valueType:"digit",render:(t,r)=>{const f=typeof t=="number"?t:0,k=typeof r.totalHours=="number"?r.totalHours:0;return e.jsxs("span",{style:{color:f>k?"#FF4D4F":"inherit"},children:[f,"h"]})}},{title:"剩余工时",dataIndex:"remainingHours",width:100,valueType:"digit",render:t=>{const r=typeof t=="number"?t:0;return e.jsxs("span",{style:{color:r<0?"#FF4D4F":"#52C41A"},children:[r,"h"]})}},{title:"状态",dataIndex:"status",width:100,valueType:"select",valueEnum:{in_progress:{text:"进行中",status:"Processing"},pending:{text:"待启动",status:"Default"},completed:{text:"已完成",status:"Success"},paused:{text:"暂停",status:"Error"}},render:(t,r)=>e.jsx(b,{color:E(r.status),children:H(r.status)})},{title:"操作",valueType:"option",width:240,fixed:"right",render:(t,r)=>[e.jsx("a",{style:{color:"#1677FF"},onClick:()=>a(`/project/task?projectId=${r.id}`),children:"任务管理"},"task"),e.jsx("a",{onClick:()=>T(r),children:"编辑"},"edit"),e.jsx("a",{style:{color:"#FF4D4F"},onClick:F,children:"删除"},"delete")]}];return e.jsxs("div",{children:[e.jsx(M,{columns:P,actionRef:s,request:async()=>{const t=await _.getProjects();return{data:t,success:!0,total:t.length}},rowKey:"id",search:{labelWidth:"auto",defaultCollapsed:!1},pagination:{defaultPageSize:10,showSizeChanger:!0},dateFormatter:"string",headerTitle:"项目列表",toolBarRender:()=>[e.jsx(u,{type:"primary",icon:e.jsx(V,{}),onClick:O,children:"新增项目"},"add"),e.jsx(u,{icon:e.jsx(K,{}),children:"导入项目"},"import"),e.jsx(u,{icon:e.jsx(A,{}),children:"导出Excel"},"export"),e.jsx(u,{icon:e.jsx(q,{}),onClick:()=>a("/task"),children:"任务管理"},"task")],options:{density:!1,fullScreen:!1,reload:!0,setting:!1}}),e.jsx(w,{title:x?"编辑项目":"新增项目",open:o,onOk:S,onCancel:()=>d(!1),width:600,children:e.jsxs(i,{form:n,layout:"vertical",children:[e.jsx(i.Item,{name:"name",label:"项目名称",rules:[{required:!0,message:"请输入项目名称"}],children:e.jsx(p,{placeholder:"请输入项目名称"})}),e.jsx(i.Item,{name:"category",label:"项目分类",rules:[{required:!0,message:"请选择项目分类"}],children:e.jsxs(l,{placeholder:"请选择项目分类",children:[e.jsx(l.Option,{value:"empower",children:"赋能项目"}),e.jsx(l.Option,{value:"support",children:"支持项目"}),e.jsx(l.Option,{value:"maintenance",children:"维护项目"})]})}),e.jsx(i.Item,{name:"managerName",label:"负责人",rules:[{required:!0,message:"请选择负责人"}],children:e.jsxs(l,{placeholder:"请选择负责人",children:[e.jsx(l.Option,{value:"项目经理",children:"项目经理"}),e.jsx(l.Option,{value:"张三",children:"张三"})]})}),e.jsx(i.Item,{name:"status",label:"项目状态",rules:[{required:!0,message:"请选择项目状态"}],children:e.jsxs(l,{placeholder:"请选择项目状态",children:[e.jsx(l.Option,{value:"in_progress",children:"进行中"}),e.jsx(l.Option,{value:"pending",children:"待启动"}),e.jsx(l.Option,{value:"completed",children:"已完成"}),e.jsx(l.Option,{value:"paused",children:"暂停"})]})}),e.jsx(i.Item,{name:"planTime",label:"计划时间",rules:[{required:!0,message:"请选择计划时间"}],children:e.jsx(L,{style:{width:"100%"}})}),e.jsx(i.Item,{name:"totalHours",label:"预计工时",rules:[{required:!0,message:"请输入合计工时"}],children:e.jsx(p,{type:"number",placeholder:"请输入合计工时",step:.5})}),e.jsx(i.Item,{name:"description",label:"备注",children:e.jsx(p.TextArea,{rows:4,placeholder:"请输入备注"})})]})})]})};export{ue as default};
